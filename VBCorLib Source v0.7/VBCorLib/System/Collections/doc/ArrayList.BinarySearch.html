<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
  <meta http-equiv="Content-Type" content="Text/html; charset=iso-8859-1">
  <meta name="Author" content = "m.stamenov" >
  <meta name="GENERATOR" content="VBDOX [2.0.23]" >
  <link REL="stylesheet" TYPE="text/css" HREF="backsdk4.css">
  <script SRC="langref.js"></script>
  <title>ArrayList:&nbsp;BinarySearch</title>
</head>
<BODY TOPMARGIN="0">
<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>ArrayList:&nbsp;BinarySearch</TD></TR>
</TABLE>
<!-- ============ METHOD ENTRY ============ -->
<H1>BinarySearch</H1>
<P>
 Performs a binary search for the value in the internal list.

<PRE class=syntax><B><font class="keyword">&nbsp;Public</font><font class="keyword">&nbsp;Function</font><font class="identifier">&nbsp;BinarySearch</font>(
	&nbsp;<font class="keyword">&nbsp;ByRef</font><font class="identifier">&nbsp;value</font><font class="keyword">&nbsp;As</font><font class="keyword">&nbsp;Variant</font>,
	&nbsp;<font class="keyword">&nbsp;Optional</font><font class="keyword">&nbsp;ByVal</font><font class="identifier">&nbsp;StartIndex</font><font class="keyword">&nbsp;As</font><font class="keyword">&nbsp;Long</font>,
	&nbsp;<font class="keyword">&nbsp;Optional</font><font class="keyword">&nbsp;ByVal</font><font class="identifier">&nbsp;Count</font><font class="keyword">&nbsp;As</font><font class="keyword">&nbsp;Long</font>&nbsp;=&nbsp;-<font class="number">&nbsp;1</font>,
	&nbsp;<font class="keyword">&nbsp;Optional</font><font class="keyword">&nbsp;ByVal</font><font class="identifier">&nbsp;Comparer</font><font class="keyword">&nbsp;As</font><font class="identifier">&nbsp;IComparer</font>&nbsp;)<font class="keyword">&nbsp;As</font><font class="keyword">&nbsp;Long</font></B></PRE>
<H4>Parameters</H4>
<DL>
<DT><I>value</I></TD>
<DD>
[ByRef]
 <B>Variant</B>.
  The value to search for.
 
</DD>
<DT><I>StartIndex</I></TD>
<DD>
[ByVal]
 Optional.
 <B>Long</B>.
   The starting index to begin the search.
 
</DD>
<DT><I>Count</I></TD>
<DD>
[ByVal]
 Optional.
 <B>Long</B>.
  The number of elements to search in from the startindex.
 
&nbsp;<P><B>Default:</B>  - 1</P>
</DD>
<DT><I>Comparer</I></TD>
<DD>
[ByVal]
 Optional.
 <B>IComparer</B>.
  A comparer to perform user-defined comparison logic.
 
</DD>
</DL>
<H4>Return Values</H4>
<B>Long</B>&nbsp;-&nbsp; The index at which the value was found, or a negative value indicating
 the value was not found.
 
<H4>Remarks</H4>
<P> The search assumes the <b>ArrayList</b> is sorted.
 <p>The default comparison method requires the values to be of the same
 intrinsic Visual Basic datatype. A vbLong will fail to compare against a vbInteger,
 for instance. Objects must implement the <b>IComparable</b> interface or
 an exception will be thrown.</p>
 <p>The comparison behaviour can be overridden by supplying a custom <b>IComparer</b>
 compatible object.</P>
 <p>The search can be limited to a specific range within the list instead
 of over the entire list.</p>
 <p>If the return value is negative, then the value was not found in the list. To
 determine where the value should have been found, negate (Not) the return value.</p>
  
<h4>Exceptions</h4>
<table>
<tr>
<th width="50%">Exception Type</th><th>Condition</th>
</tr><tr>
<td>ArgumentException</td>
<td>Neither <i>value</i> nor the elements in the list support the <b>IComparable</b> interface.</td>
</tr>
<tr>
<td>InvalidOperationException</td>
<td><i>value</i> and the elements in the array are not of the same datatype.</td>
</tr>
</table>
<h4>Example</h4>
The following code demonstrates how to search for a value in an <b>ArrayList</b> using BinarySearch.
<pre>
Private Sub Main()
    Dim list As New ArrayList
    Dim i As Integer
    
    For i = 1 To 5
        list.Add i * 2
    Next i
    
    ' Display the current values in the list
    Console.WriteLine "The ArrayList contains:"
    PrintValues list
    
    ' Find a non-existing value
    FindValue list, 7
    
    ' Find an existing value
    FindValue list, 4
    
    Console.ReadLine
End Sub

Private Sub PrintValues(ByVal en As IEnumerable)
    Dim v As Variant
    
    Console.WriteValue vbTab
    
    For Each v In en
        Console.WriteValue "{0} ", v
    Next v
    Console.WriteLine
End Sub

Private Sub FindValue(ByVal list As ArrayList, ByVal value As Variant)
    Dim Index As Long
    
    Index = list.BinarySearch(value)
    
    If Index < 0 Then
        Console.WriteLine "The value ({0}) was not found in the list. The next largest value was found at index {1}.", value, Not Index
    Else
        Console.WriteLine "the value ({0}) was found at index {1}.", value, Index
    End If
End Sub

' This code produces the following output.
'
' The ArrayList contains:
'     2 4 6 8 10
' The value (7) was not found in the list. the next largest value was found at index 3.
' The value (4) was found at index 1.
</pre>
</P>
<H4>See Also</H4>
<P>
<A HREF="ArrayList.html">Class ArrayList Overview</A>
| IComparer
| IComparable
<DIV class=footer>Build on Sunday, March 06, 2005 by Kelly Ethridge<BR>Copyright &copy; 2004 ABB MC</DIV>
<DIV class=footer style="COLOR: #000000; FONT-SIZE: 90%">
</body>
</html>
